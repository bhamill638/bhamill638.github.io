<!DOCTYPE html>


<html lang="en-gb" data-theme="">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>What is Nmap?</title>
<meta name="description" content="A blog for personal thoughts and guides relating to cyber security and software">

<link rel="icon" type="image/x-icon" href="https://brian.hamill.dev/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://brian.hamill.dev/favicon.png">

<link rel="stylesheet" href="https://brian.hamill.dev/css/light.css?rnd=1652093508" />
<style>

    [data-theme="dark"] {   
        --font-color: #eee;
--bg-color: #212121;

--link-color:#599ada;
--link-state-color:#ff5858;
--link-state-border-color: rgba(238, 54, 54, 0.5);

--thead-bg-color: #343a40;
--table-border-color: lightgrey;

--pre-color: #333;
--pre-bg-color: #f1f1f1;

--bq-color: #ccc;
--hr-color: #333;

--pagination-bg-color: #373737;
--pagination-link-color: #b6b6b6;

--post-info-color: grey;

--switcher-color: #333;
--switcher-bg-color: #fff;

    }

</style>

<link rel="stylesheet" href="https://brian.hamill.dev/css/style.css?rnd=1652093508" />





<meta property="og:title" content="What is Nmap?" />
<meta property="og:description" content="What is Nap, what is it used for and what can it do?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://brian.hamill.dev/posts/nmap/" />
<meta property="article:published_time" content="2022-05-09T10:40:00+01:00" />
<meta property="article:modified_time" content="2022-05-09T10:40:00+01:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="What is Nmap?"/>
<meta name="twitter:description" content="What is Nap, what is it used for and what can it do?"/>








    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header"> 
            
                <h1 class="site-title">
    <a href="/">Brian&#39;s Blog</a>
</h1>

    <nav></nav>


            
        </header>
        <main id="main" tabindex="-1"> 
            
    
    
    <article class="post">
        <header class="post-header">
            <h1 class="post-title">What is Nmap?</h1>
        </header>
        <div class="content">
            <p><a href="https://nmap.org/" rel="nofollow noreferrer" target="_blank">Nmap</a> (“Network Mapper”) is a free, open source, network scanning tool.</p>

<p>Nmap is a widely used tool that can scan a network and identify the machines on the network, or can be used to scan an individual machine to find out useful info about that device such as; the operating system of the host (computer/device), the applications or services running on the machine and which ports are open for those services.</p>

<h1 id="disclaimer">Disclaimer</h1>

<p>Running the Nmap tool, or any network scanning tool, can be interpreted as illegal depending on local or country-specific laws. Please ensure you have permission to perform a scan of a network/device before beginning. If you just want to try Nmap out and follow along with this blog, performing scans on devices that are on your home network will work just fine. You can also use <a href="http://scanme.nmap.org" rel="nofollow noreferrer" target="_blank">scanme.nmap.org</a> so long as you abide by the restrictions mentioned on that web page.</p>

<h1 id="assumptions">Assumptions</h1>

<p>There are a number of key technical terms and practices that will be covered which are listed here. All of the <code>nmap</code> commands shown in this post are done from within the command line (aka terminal).</p>

<ul>
<li>How to use the command line on <a href="https://www.computerhope.com/issues/chusedos.htm" rel="nofollow noreferrer" target="_blank">Windows</a>, <a href="https://www.macworld.co.uk/how-to/mac-software/how-use-terminal-on-mac-3608274/" rel="nofollow noreferrer" target="_blank">Mac</a> or <a href="https://www.howtogeek.com/140679/beginner-geek-how-to-start-using-the-linux-terminal/" rel="nofollow noreferrer" target="_blank">Linux</a></li>
<li><a href="https://nmap.org/book/install.html" rel="nofollow noreferrer" target="_blank">Installing Nmap</a></li>
<li><a href="https://www.lifewire.com/what-is-an-ip-address-2625920" rel="nofollow noreferrer" target="_blank">What is an IP address?</a></li>
<li><a href="https://www.bleepingcomputer.com/tutorials/tcp-and-udp-ports-explained/" rel="nofollow noreferrer" target="_blank">What is a port?</a></li>
<li><a href="https://www.cloudflare.com/en-gb/learning/network-layer/what-is-a-subnet/" rel="nofollow noreferrer" target="_blank">A basic understanding of what a subnet is</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/understanding-ip-addresses-subnets-and-cidr-notation-for-networking#cidr-notation" rel="nofollow noreferrer" target="_blank">Knowledge of CIDR notation may be useful but not 100% necessary</a></li>
</ul>

<h1 id="basic-usage-of-nmap">Basic usage of Nmap</h1>

<p>The most simple usage of Nmap is to scan one device&rsquo;s IP address or website URL such as the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">nmap 45.33.32.156
<span style="color:#75715e"># or</span>
nmap scanme.nmap.org</code></pre></div>
<p>This command will scan the IP address provided, checking the 1000 most common ports and will produce results showing which ports are open and what service is likely to be using that port.
Check out <a href="https://nullsec.us/top-1-000-tcp-and-udp-ports-nmap-default/" rel="nofollow noreferrer" target="_blank">this blog post</a> to know more about which ports are scanned.</p>

<p>The output will look something like this:</p>

<p><img src="/nmap1.png" alt="a screenshot showing the mac terminal output of the nmap command run against scanme.nmap.org" /></p>

<h2 id="interpreting-the-results">Interpreting the Results</h2>

<p>While the output may look confusing at first, it doesn&rsquo;t take long to understand how to pull out the useful information. The first four lines give some details about the scan, we can mostly ignore these lines to focus on the main content:</p>

<p><img src="/nmap2.png" alt="a screenshot showing the mac terminal output of the nmap command run against scanme.nmap.org with a red rectangle highlighting the section of results starting with the port, state and service" /></p>

<p>The results of our scan are displayed in three columns; port, state and service.</p>

<ul>
<li><strong>PORT</strong>: gives us both the port number and the type of protocol that was found, TCP (Transfer Control Protocol) or UDP (User Datagram Protocol).</li>
<li><strong>STATE</strong>: lets us know if the port is open, filtered or unfiltered. (There are also two states for when Nmap isn&rsquo;t sure if the port is open or closed AND filtered)</li>
<li><strong>SERVICE</strong>: gives us info on which service is most likely to be running on this port at the time (for example HTTP shown in the above screenshot)</li>
</ul>

<p>This means that the above screenshot shows the website <code>scanme.nmap.org</code> with the IP address <code>45.33.32.156</code> has TCP ports 80, 443, 3128 and 8080 open.</p>

<p><strong>What does that mean?</strong></p>

<p>Ports 80 and 443 are used for HTTP and HTTPS respectively, which means this is a website as we can tell by going to the URL in our browser.<br />
Port 3128 is often used by the squid-proxy service which is, unsurprisingly, a proxy, finally port 8080 is a HTTP proxy.</p>

<h1 id="scanning-multiple-ip-addresses">Scanning Multiple IP Addresses</h1>

<p>Nmap also has a number of ways to scan multiple devices on a network, it can handle space-separated IP addresses, a range of addresses or <a href="https://www.ionos.com/digitalguide/server/know-how/cidr-classless-inter-domain-routing/" rel="nofollow noreferrer" target="_blank">CIDR notation</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Scan these three space-separated IP addresses:</span>
nmap 192.168.0.1 192.168.0.2 192.168.0.3
 
<span style="color:#75715e"># Scan this range of IP addresses:</span>
nmap 192.168.0.1-3
 
<span style="color:#75715e"># Scan this block of IP addresses using CIDR notation</span>
<span style="color:#75715e"># (This will scan all addresses from 192.168.0.1 to 192.168.0.254):</span>
nmap 192.168.0.0/24</code></pre></div>
<h1 id="nmap-flags">Nmap Flags</h1>

<p>Now that we know the basic usage and understand the results we can use different flags to make Nmap do many different things. We can get it to scan all 65535 ports, make it scan slower or faster or even get an idea of what operating system is running on the target device. To do this we add <a href="https://nmap.org/book/port-scanning-options.html" rel="nofollow noreferrer" target="_blank">&lsquo;flags&rsquo;</a> to our <code>nmap</code> command.</p>

<h2 id="common-flags">Common Flags:</h2>

<table>
<thead>
<tr>
<th>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>-A</td>
<td>Aggressive scan - “Enable OS detection, version detection, script scanning, and traceroute”.</td>
</tr>

<tr>
<td>-p 22</td>
<td>Port number - specifies a port or list of ports (comma separated) to scan.</td>
</tr>

<tr>
<td>-p-</td>
<td>Scan all ports.</td>
</tr>

<tr>
<td>-T4</td>
<td>Set a timing template - Sets how fast Nmap will perform the scan on the network, with values from 0-5. Zero and one are intended to bypass detection as they are so slow they may not be flagged by monitoring tools. If the T flag is not specified the default speed is 3 - &lsquo;normal&rsquo;.</td>
</tr>

<tr>
<td>-v</td>
<td>Verbose output - Prints more information about the scan while it is running, such as when an open port is found and an estimated completion time.</td>
</tr>

<tr>
<td>-sS</td>
<td>Stealth scan - Harder to detect as TCP connections are not completed with this flag specified.</td>
</tr>

<tr>
<td>-oN filename.txt</td>
<td>Normal output - Saves the scan results to an output text file.</td>
</tr>

<tr>
<td>-Pn</td>
<td>Stops Nmap sending pings to identify if a host is up or down. Sometimes hosts deliberately won&rsquo;t respond to pings so this flag needs to be set. More info on this <a href="https://security.stackexchange.com/a/31855" rel="nofollow noreferrer" target="_blank">here</a>.</td>
</tr>

<tr>
<td>-sC</td>
<td>Scripted scan - Runs a number of <a href="https://nmap.org/nsedoc/categories/default.html" rel="nofollow noreferrer" target="_blank">default scripts</a> against a target to find info such as MAC address, listing discovered directories and fingerprinting usernames.</td>
</tr>

<tr>
<td>-sn</td>
<td>Ping scan - Pings the host(s) to see if they exist.</td>
</tr>

<tr>
<td>-sU</td>
<td>Perform a UDP scan.</td>
</tr>

<tr>
<td>&ndash;help</td>
<td>Nmap help - Displays useful information such as command syntax and a list of flags and options.</td>
</tr>
</tbody>
</table>

<h1 id="saving-results">Saving Results</h1>

<p>It&rsquo;s possible to save the output of an Nmap scan to a file. This is useful for various reasons; doing an official pentest on a company and need to keep detailed evidence of findings or you want to compare the results over time to see if specific ports have opened or closed recently. You may even want to create a script to interpret or process these results programmatically. Luckily Nmap has a number of different output types to choose from.</p>

<p>There are four main formats for nmap results; normal, XML, grepable and &lsquo;all&rsquo;:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">nmap -oN output_filename.nmap scanme.nmap.org
nmap -oX output_filename.xml scanme.nmap.org
nmap -oG output_filename.gnmap scanme.nmap.org
nmap -oA output_filename scanme.nmap.org</code></pre></div>
<p><code>-oN</code> - <strong>Normal</strong> - saves the results to a file that looks almost identical to the results we see in the terminal, this is the most human readable output type.</p>

<p><code>-oX</code> - <strong>XML</strong> - saves the output to XML format which can be easily parsed and used by various scripting languages. This format is often desired if you&rsquo;re planning on writing a script that will do something with the scan results.</p>

<p><code>-oG</code> - <strong>Grepable</strong> - saves the output so that it&rsquo;s easily parsable by a number of common Unix command line tools such as grep, sed and awk. This is helpful if you&rsquo;re wanting to write a quick script to pull out a specific field or check results.</p>

<p><code>-oA</code> - <strong>All</strong> - saves the scan results in all three of the above formats which can be handy if you want to keep the results for later but are not sure how you&rsquo;ll process them yet.</p>

<h1 id="use-nmap-to-find-all-devices-on-a-network">Use Nmap to Find all Devices on a Network</h1>

<p>There is no single, <em>completely</em> accurate way to find all devices on a network, there will always be caveats and situations where certain devices might be missed, however Nmap can give us a good rough estimate of what hosts are available and discoverable.</p>

<p>As mentioned in the <a href="#scanning-multiple-ip-addresses">Scanning Multiple IP Addresses</a> section we can use CIDR notation to scan a block/range of IP addresses, this is generally the easiest method when attempting to find all devices.</p>

<p>To get our rough estimate of devices on a network we can check all IPs from 192.168.0.1 to 192.168.0.254 using the following command with the <code>-sn</code> flag:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">nmap -sn 192.168.0.0/24</code></pre></div>
<p>This command will ping all devices in that IP range and output a list of the hosts that returned a response. According to <a href="https://security.stackexchange.com/a/36200" rel="nofollow noreferrer" target="_blank">this stackexchange post</a> if the ping fails Nmap will attempt to send SYN packages to the device on port 80. Unfortunately neither of these methods are a guaranteed way to see if a device definitely exists or doesn&rsquo;t since the device may be configured both to not respond to pings and to not respond to SYN requests on port 80.</p>

<p>If you need an absolutely definitive list of hosts you can omit the <code>-sn</code> flag and scan the 1000 most common ports of every IP, specify certain ports or even add the <code>-p-</code> flag and scan all ports of every IP, but any of these will take a very long to complete and might not be very useful unless you&rsquo;re doing full internal network discovery for a pentest or professional engagement.</p>

<h1 id="common-flags-for-routine-usage">Common Flags for Routine Usage</h1>

<p>There are two main variations of the Nmap command that would be my go-to commands when using this tool; A quick scan of the most common ports and a full scan of all ports including OS detection.</p>

<p>The quick scan is for when I want to know if a machine has ports such as 8080 or 22 open etc. The &lsquo;full&rsquo; scan command was mostly what I used when working as a pentester, I&rsquo;d kick off the scan to check all ports and find the operating system because even though this usually takes a good 10 mins to complete the info was very useful for identifying services to attack.</p>

<p>These two commands are:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Quick scan of the common ports</span>
nmap scanme.nmap.org
 
<span style="color:#75715e"># &#39;Full&#39; scan of all the ports with OS detection etc</span>
nmap -p- -A scanme.nmap.org</code></pre></div>
<p><em>Note:</em> The <code>-Pn</code> flag may need added if the target machine doesn&rsquo;t respond to pings, but the good news is that Nmap generally shows a message mentioning this if that&rsquo;s the case.</p>

<h1 id="further-reading">Further Reading</h1>

<p>If you&rsquo;re wanting to learn more about Nmap, advanced usage or more about port scanning these links might be helpful:</p>

<ul>
<li><a href="https://nmap.org/book/man.html" rel="nofollow noreferrer" target="_blank">Nmap documentation</a></li>
<li><a href="https://nmap.org/zenmap/" rel="nofollow noreferrer" target="_blank">Zenmap, the Nmap GUI</a></li>
<li><a href="https://bytexd.com/how-to-use-nmap/" rel="nofollow noreferrer" target="_blank">A comprehensive guide on Nmap</a></li>
<li><a href="https://www.opensourceforu.com/2011/04/advanced-nmap-nmap-script-scanning/" rel="nofollow noreferrer" target="_blank">Nmap Scripting Engine (NSE) guide</a></li>
<li><a href="https://nudesystems.com/11-most-used-nmap-commands-for-advanced-scanning/" rel="nofollow noreferrer" target="_blank">Commands for advanced scanning</a></li>
<li><a href="https://danielmiessler.com/study/masscan/" rel="nofollow noreferrer" target="_blank">Masscan, port scan the entire internet in minutes</a></li>
<li><a href="https://nmap.org/book/scan-methods-udp-scan.html" rel="nofollow noreferrer" target="_blank">UDP scanning with Nmap</a></li>
</ul>
        </div>
        

    


<div class="post-info">
    
        <div class="post-date">9 May 2022</div>
    
    <div class="post-taxonomies">
        
            
    </div>
</div>

    </article>

    

    


        </main>
        
            <footer class="common-footer">
    
    

     

    <div class="common-footer-bottom">
        <div class="copyright">
            <p>© Brian Hamill, 2022<br>
            Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.
            </p>  
        </div> 

        


   
    </div>

</footer>

        
    </div>
</body>
</html>
